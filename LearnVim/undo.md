# 撤销

## 撤销(undo)，重做和行撤销(UNDO)
Vim 是如何知道应该恢复多少修改呢？ 答案是，Vim每次仅恢复一次修改，这有点类似于点命令的操作（和 点命令不同之处在于，命令行命令也会被算作一次修改）。

要取消上一次的撤销，可以执行 Ctrl-r 或者 :redo。

Vim 也有另一个命令 U 可以实现 行撤销 (UNDO) 的功能，执行这个命令会撤销所有最新的修改。

那么，U 和 u 的区别是什么呢？首先，U 会删除 最近修改的行中所有的 的修改，而 u 一次仅删除一次修改。 其次，执行u 不会被算作一次修改操作，而执行 U 则会被算作一次修改。

## 断点插入操作
当你在插入模式时，按下 ctrl-g u 会生成一个断点。例如，如果你执行 ione <ctrl-g u>two <ctrl-g u>three<esc>，之后你按下u，你仅会失去文本 “three”，再次执行 u，会删除 “two”。当你想要输入一长段内容时，应该有选择性地执行断点插入操作。在每一句话的末尾，两个段落的中间，或者每一行代码结束时插入断点是一个很好的选择，这可以帮助你快速从错误中恢复出来。

## 撤销树
在 Vim 中，你每一次执行 u 去做一次修改时，Vim都会通过创建一个"撤销分支"来保存之前的文本内容。在本例中，你输入"two"后, 执行 u，然后输入"three"，你就创建了一个叶子分支,保存了含有"two"的文本状态。此时，撤销树已经包含了至少两个叶子节点，主节点包含文本"three"（最新），而另一undo分支节点包含文本“two”。假如你执行了另一次撤销操作并且输入了"four"，那么此时会生成三个节点，一个主节点包含文本"four", 以及另外两个节点分别存储了"three"和"two"。

为了在几个不同的节点状态间进行切换，你可以执行 g+ 去获取一个较新的状态，以及执行 g- 去获取一个教旧的状态。 u， Ctrl-R， g+， 和 g- 之间的区别是，u and Ctrl-R 只可以在 main 节点之间进行切换，而g+ 和 g- 可以在 所有 节点之间进行切换。

## 保存撤销记录



